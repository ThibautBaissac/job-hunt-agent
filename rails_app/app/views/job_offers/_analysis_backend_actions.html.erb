<% presenter ||= JobOfferPresenter.new(job_offer) %>
<% default_backend = ENV.fetch("DEFAULT_OFFER_ANALYSIS_BACKEND", "rails") %>
<% selected_backend = (local_assigns[:selected_backend] || presenter.job_offer.analysis_backend || default_backend).to_s %>
<div class="flex flex-wrap gap-2">
  <% presenter.available_backends.each do |backend| %>
    <% key = backend[:key] %>
    <% label = backend[:label] %>
    <% active = selected_backend == key %>
    <% base_classes = "inline-flex items-center gap-2 rounded-md border px-3 py-1.5 text-xs font-semibold transition" %>
    <% active_classes = active ? "border-indigo-300 bg-indigo-900 text-white hover:bg-indigo-800" : "border-indigo-200 bg-white text-indigo-900 hover:bg-indigo-50" %>
    <%= button_to "Analyser via #{label}",
          analyze_job_offer_path(job_offer),
          method: :post,
          params: { backend: key },
          class: [base_classes, active_classes].join(" "),
          data: { turbo_stream: true } %>
  <% end %>
</div>
